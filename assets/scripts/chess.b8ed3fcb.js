"use strict";(self.webpackChunkrap=self.webpackChunkrap||[]).push([[5030],{70971:function(e,s,n){n.r(s),n.d(s,{default:function(){return X}});var a=n(67294),r=n(64593),o=n(31753),c=n(46458),l=n(23828),t=n(68875),i=n(31941),C=n(41120),h=n(94184),u=n.n(h),A=n(5200),m=(0,a.createContext)({picking:null,targets:null,halfMove:null,pickChessman:null,releaseChessman:null});function d(e,s){return e.file===s.file&&e.rank===s.rank}var p=n(90365),b=n(93379),g=n.n(b),E=n(32425),k={insert:"head",singleton:!1},q=(g()(E.Z,k),E.Z.locals||{});const _=(0,C.Z)((e=>({Chessman:{"&$Picking:not($Dragging)":{color:e.palette.primary.A700}},Picking:{},Dragging:{}})));var f=e=>{let{chessman:s,coord:n}=e;const{picking:r,pickChessman:o}=(0,a.useContext)(m),c=_(),[{dragging:l},t,i]=(0,A.c)({type:"Chessman",collect:e=>({dragging:e.isDragging()}),item:()=>(null==o||o(s,n),{})}),C=(0,a.useMemo)((()=>u()(c.Chessman,q.Chessman,{[c.Dragging]:l,[c.Picking]:null!=r&&d(n,r.source)&&(0,p.Z)(s,r.chessman),[q.Dragging]:l})),[c.Chessman,c.Dragging,c.Picking,l,s,n,r]),h=(0,a.useMemo)((()=>u()(c.Chessman,q.Chessman,q.Preview)),[c.Chessman]),b=(0,a.useCallback)((()=>{null==r&&(null==o||o(s,n))}),[r,o,s,n]);return a.createElement(a.Fragment,null,a.createElement("span",{ref:i,className:h},s.symbol),a.createElement("span",{ref:t,className:C,onClick:b},s.symbol))},v=n(59240);var S=n(11471),B={insert:"head",singleton:!1},w=(g()(S.Z,B),S.Z.locals||{});const y=(0,C.Z)((e=>({Square:{"&$Square$Target":{backgroundColor:e.palette.primary[100]}},Target:{}})));var T=e=>{let{children:s,coord:n}=e;const{picking:r,targets:o,halfMove:c,releaseChessman:l}=(0,a.useContext)(m),t=y(),i=(0,a.useMemo)((()=>{var e;return null!==(e=null==o?void 0:o.some((e=>d(n,e))))&&void 0!==e&&e}),[n,o]),[,C]=(0,v.L)({accept:"Chessman",drop(){null!=r&&(i?null==c||c(r.chessman,r.source,n):null==l||l())}}),h=(0,a.useMemo)((()=>function(e){let{file:s,rank:n}=e;return s%2==n%2?"black":"white"}(n)),[n]),A=(0,a.useMemo)((()=>u()(t.Square,w.Square,{[w.White]:"white"===h,[w.Black]:"black"===h,[t.Target]:i})),[t.Square,t.Target,h,i]),p=(0,a.useCallback)((()=>{null!=r&&(i?null==c||c(r.chessman,r.source,n):null==l||l())}),[c,r,n,l,i]);return a.createElement("div",{ref:C,className:A,onClick:p},s)},x=n(1617),P={insert:"head",singleton:!1},D=(g()(x.Z,P),x.Z.locals||{});const Z=[1,2,3,4,5,6,7,8],M=[8,7,6,5,4,3,2,1],N={resetBoard:i.iH};var W=(0,c.$j)((e=>{let{chess:{board:s}}=e;return{board:s}}),N)((e=>{let{board:s,resetBoard:n}=e;return(0,a.useEffect)((()=>{n()}),[n]),a.createElement("table",{className:D.ChessboardTable,dir:"ltr"},a.createElement("tbody",null,M.map((e=>a.createElement("tr",{key:e},Z.map((n=>{const r=new t.Z({file:n,rank:e}),o=s.chessmen.get(r);return a.createElement("td",{key:n,className:D.ChessboardTd},a.createElement(T,{coord:r},void 0!==o?a.createElement(f,{chessman:o,coord:r}):null))})))))))})),O=n(13833),R=(0,n(85315).vU)({chess:{id:"src.components.App.ChessPage.chess",defaultMessage:"Chess"}});var X=(0,O.D)((()=>{const{formatMessage:e}=(0,o.Z)(),s=(0,c.v9)((e=>e.chess.picking)),n=(0,c.v9)((e=>e.chess.targets)),t=(0,c.I0)();return a.createElement(a.Fragment,null,a.createElement(r.Z,{title:e(R.chess)}),a.createElement(m.Provider,{value:{picking:s,targets:n,halfMove:(0,l.qC)(t,i.p4),pickChessman:(0,l.qC)(t,i.Ns),releaseChessman:(0,l.qC)(t,i.Yu)}},a.createElement(W,null)))}))},32425:function(e,s,n){var a=n(94015),r=n.n(a),o=n(23645),c=n.n(o)()(r());c.push([e.id,'.src-components-Chessboard-Chessman-classes__Chessman--qR3Nh {\n  font-family: "Apple Symbols", sans-serif;\n  color: #222;\n}\n\n.src-components-Chessboard-Chessman-classes__Chessman--qR3Nh.src-components-Chessboard-Chessman-classes__Dragging--PXXIT {\n  opacity: 0.5;\n}\n\n/* TODO: in a little more normal way */\n.src-components-Chessboard-Chessman-classes__Chessman--qR3Nh.src-components-Chessboard-Chessman-classes__Preview--yN4xk {\n  position: absolute;\n  z-index: -1;\n}\n',"",{version:3,sources:["webpack://./src/components/Chessboard/Chessman/classes.css"],names:[],mappings:"AAAA;EACE,wCAAwC;EACxC,WAAW;AACb;;AAEA;EACE,YAAY;AACd;;AAEA,sCAAsC;AACtC;EACE,kBAAkB;EAClB,WAAW;AACb",sourcesContent:['.Chessman {\n  font-family: "Apple Symbols", sans-serif;\n  color: #222;\n}\n\n.Chessman.Dragging {\n  opacity: 0.5;\n}\n\n/* TODO: in a little more normal way */\n.Chessman.Preview {\n  position: absolute;\n  z-index: -1;\n}\n'],sourceRoot:""}]),c.locals={Chessman:"src-components-Chessboard-Chessman-classes__Chessman--qR3Nh",Dragging:"src-components-Chessboard-Chessman-classes__Dragging--PXXIT",Preview:"src-components-Chessboard-Chessman-classes__Preview--yN4xk"},s.Z=c},11471:function(e,s,n){var a=n(94015),r=n.n(a),o=n(23645),c=n.n(o)()(r());c.push([e.id,".src-components-Chessboard-Square-classes__Square--SMPbq {\n  height: 32px;\n  width: 32px;\n  font-size: 20px; /* of chessman; FIXME */\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  --white-square-color: white;\n  --black-square-color: #c0c0c0;\n}\n\n/* NOTE: できれば .Square.White にしたいが、そうすると postcss-css-variables がうまく動作しない。 */\n.src-components-Chessboard-Square-classes__White--dpDOU.src-components-Chessboard-Square-classes__Square--SMPbq {\n  background-color: white;\n  background-color: var(--white-square-color);\n}\n\n.src-components-Chessboard-Square-classes__Black--bL\\+Px.src-components-Chessboard-Square-classes__Square--SMPbq {\n  background-color: #c0c0c0;\n  background-color: var(--black-square-color);\n}\n","",{version:3,sources:["webpack://./src/components/Chessboard/Square/classes.css"],names:[],mappings:"AAAA;EACE,YAAY;EACZ,WAAW;EACX,eAAe,EAAE,uBAAuB;EACxC,aAAa;EACb,mBAAmB;EACnB,uBAAuB;;EAEvB,2BAA2B;EAC3B,6BAA6B;AAC/B;;AAEA,0EAA0E;AAC1E;EACE,uBAA2C;EAA3C,2CAA2C;AAC7C;;AAEA;EACE,yBAA2C;EAA3C,2CAA2C;AAC7C",sourcesContent:[".Square {\n  height: 32px;\n  width: 32px;\n  font-size: 20px; /* of chessman; FIXME */\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  --white-square-color: white;\n  --black-square-color: #c0c0c0;\n}\n\n/* NOTE: できれば .Square.White にしたいが、そうすると postcss-css-variables がうまく動作しない。 */\n.White.Square {\n  background-color: var(--white-square-color);\n}\n\n.Black.Square {\n  background-color: var(--black-square-color);\n}\n"],sourceRoot:""}]),c.locals={Square:"src-components-Chessboard-Square-classes__Square--SMPbq",White:"src-components-Chessboard-Square-classes__White--dpDOU",Black:"src-components-Chessboard-Square-classes__Black--bL+Px"},s.Z=c},1617:function(e,s,n){var a=n(94015),r=n.n(a),o=n(23645),c=n.n(o)()(r());c.push([e.id,".src-components-Chessboard-classes__ChessboardTable--DKVq\\+ {\n  border-collapse: collapse;\n}\n\n.src-components-Chessboard-classes__ChessboardTd--848Kp {\n  padding: 0;\n}\n","",{version:3,sources:["webpack://./src/components/Chessboard/classes.css"],names:[],mappings:"AAAA;EACE,yBAAyB;AAC3B;;AAEA;EACE,UAAU;AACZ",sourcesContent:[".ChessboardTable {\n  border-collapse: collapse;\n}\n\n.ChessboardTd {\n  padding: 0;\n}\n"],sourceRoot:""}]),c.locals={ChessboardTable:"src-components-Chessboard-classes__ChessboardTable--DKVq+",ChessboardTd:"src-components-Chessboard-classes__ChessboardTd--848Kp"},s.Z=c}}]);
//# sourceMappingURL=chess.b8ed3fcb.js.map