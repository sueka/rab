(self.webpackChunkreact_app_prototype=self.webpackChunkreact_app_prototype||[]).push([[30],{33720:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return Y}});var a=n(67294),r=n(64593),o=n(31753),c=n(276),t=n(14890),l=n(68875),u=n(31941),i=n(59713),C=n.n(i),A=n(63038),m=n.n(A),h=n(41120),p=n(94184),d=n.n(p),g=n(84785),b=(0,a.createContext)({picking:null,targets:null,halfMove:null,pickChessman:null,releaseChessman:null});function f(e,s){return e.file===s.file&&e.rank===s.rank}var E=n(17567),k=n(93379),_=n.n(k),v=n(32425),q={insert:"head",singleton:!1},y=(_()(v.Z,q),v.Z.locals||{}),B=(0,h.Z)((function(e){return{Chessman:{"&$Picking:not($Dragging)":{color:e.palette.primary.A700}},Picking:{},Dragging:{}}})),w=function(e){var s=e.chessman,n=e.coord,r=(0,a.useContext)(b),o=r.picking,c=r.pickChessman,t=B(),l=(0,g.useDrag)({item:{type:"Chessman"},collect:function(e){return{dragging:e.isDragging()}},begin:function(){null==c||c(s,n)}}),u=m()(l,3),i=u[0].dragging,A=u[1],h=u[2],p=(0,a.useMemo)((function(){var e;return d()(t.Chessman,y.Chessman,(e={},C()(e,t.Dragging,i),C()(e,t.Picking,null!=o&&f(n,o.source)&&(0,E.Z)(s,o.chessman)),C()(e,y.Dragging,i),e))}),[t.Chessman,t.Dragging,t.Picking,i,s,n,o]),k=(0,a.useMemo)((function(){return d()(t.Chessman,y.Chessman,y.Preview)}),[t.Chessman]),_=(0,a.useCallback)((function(){null==o&&(null==c||c(s,n))}),[o,c,s,n]);return a.createElement(a.Fragment,null,a.createElement("span",{ref:h,className:k},s.symbol),a.createElement("span",{ref:A,className:p,onClick:_},s.symbol))};var S=n(11471),T={insert:"head",singleton:!1},Z=(_()(S.Z,T),S.Z.locals||{}),W=(0,h.Z)((function(e){return{Square:{"&$Square$Target":{backgroundColor:e.palette.primary[100]}},Target:{}}})),x=function(e){var s=e.children,n=e.coord,r=(0,a.useContext)(b),o=r.picking,c=r.targets,t=r.halfMove,l=r.releaseChessman,u=W(),i=(0,a.useMemo)((function(){var e;return null!==(e=null==c?void 0:c.some((function(e){return f(n,e)})))&&void 0!==e&&e}),[n,c]),A=(0,g.useDrop)({accept:"Chessman",drop:function(){null!=o&&(i?null==t||t(o.chessman,o.source,n):null==l||l())}}),h=m()(A,2)[1],p=(0,a.useMemo)((function(){return function(e){return e.file%2==e.rank%2?"black":"white"}(n)}),[n]),E=(0,a.useMemo)((function(){var e;return d()(u.Square,Z.Square,(e={},C()(e,Z.White,"white"===p),C()(e,Z.Black,"black"===p),C()(e,u.Target,i),e))}),[u.Square,u.Target,p,i]),k=(0,a.useCallback)((function(){null!=o&&(i?null==t||t(o.chessman,o.source,n):null==l||l())}),[t,o,n,l,i]);return a.createElement("div",{ref:h,className:E,onClick:k},s)},D=n(1617),P={insert:"head",singleton:!1},M=(_()(D.Z,P),D.Z.locals||{}),N=[1,2,3,4,5,6,7,8],G=[8,7,6,5,4,3,2,1],L={resetBoard:u.iH},O=(0,c.$j)((function(e){return{board:e.chess.board}}),L)((function(e){var s=e.board,n=e.resetBoard;return(0,a.useEffect)((function(){n()}),[n]),a.createElement("table",{className:M.ChessboardTable,dir:"ltr"},a.createElement("tbody",null,G.map((function(e){return a.createElement("tr",{key:e},N.map((function(n){var r=new l.Z({file:n,rank:e}),o=s.chessmen.get(r);return a.createElement("td",{key:n,className:M.ChessboardTd},a.createElement(x,{coord:r},void 0!==o?a.createElement(w,{chessman:o,coord:r}):null))})))}))))})),H=n(72152),R=(0,n(85315).vU)({chess:{id:"src.components.App.ChessPage.chess",defaultMessage:"Chess"}}),Y=(0,H.D)((function(){var e=(0,o.Z)().formatMessage,s=(0,c.v9)((function(e){return e.chess.picking})),n=(0,c.v9)((function(e){return e.chess.targets})),l=(0,c.I0)();return a.createElement(a.Fragment,null,a.createElement(r.Z,{title:e(R.chess)}),a.createElement(b.Provider,{value:{picking:s,targets:n,halfMove:(0,t.qC)(l,u.p4),pickChessman:(0,t.qC)(l,u.Ns),releaseChessman:(0,t.qC)(l,u.Yu)}},a.createElement(O,null)))}))},32425:function(e,s,n){"use strict";var a=n(94015),r=n.n(a),o=n(23645),c=n.n(o)()(r());c.push([e.id,'.src-components-Chessboard-Chessman-classes__Chessman--1Ls2d {\n  font-family: "Apple Symbols", sans-serif;\n  color: #222;\n}\n\n.src-components-Chessboard-Chessman-classes__Chessman--1Ls2d.src-components-Chessboard-Chessman-classes__Dragging--28aag {\n  opacity: 0.5;\n}\n\n/* TODO: in a little more normal way */\n.src-components-Chessboard-Chessman-classes__Chessman--1Ls2d.src-components-Chessboard-Chessman-classes__Preview--1tGRK {\n  position: absolute;\n  z-index: -1;\n}\n',"",{version:3,sources:["webpack://./src/components/Chessboard/Chessman/classes.css"],names:[],mappings:"AAAA;EACE,wCAAwC;EACxC,WAAW;AACb;;AAEA;EACE,YAAY;AACd;;AAEA,sCAAsC;AACtC;EACE,kBAAkB;EAClB,WAAW;AACb",sourcesContent:['.Chessman {\n  font-family: "Apple Symbols", sans-serif;\n  color: #222;\n}\n\n.Chessman.Dragging {\n  opacity: 0.5;\n}\n\n/* TODO: in a little more normal way */\n.Chessman.Preview {\n  position: absolute;\n  z-index: -1;\n}\n'],sourceRoot:""}]),c.locals={Chessman:"src-components-Chessboard-Chessman-classes__Chessman--1Ls2d",Dragging:"src-components-Chessboard-Chessman-classes__Dragging--28aag",Preview:"src-components-Chessboard-Chessman-classes__Preview--1tGRK"},s.Z=c},11471:function(e,s,n){"use strict";var a=n(94015),r=n.n(a),o=n(23645),c=n.n(o)()(r());c.push([e.id,".src-components-Chessboard-Square-classes__Square--1yCGb {\n  height: 32px;\n  width: 32px;\n  font-size: 20px; /* of chessman; FIXME */\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  --white-square-color: white;\n  --black-square-color: #c0c0c0;\n}\n\n/* NOTE: できれば .Square.White にしたいが、そうすると postcss-css-variables がうまく動作しない。 */\n.src-components-Chessboard-Square-classes__White--2-a8H.src-components-Chessboard-Square-classes__Square--1yCGb {\n  background-color: white;\n  background-color: var(--white-square-color);\n}\n\n.src-components-Chessboard-Square-classes__Black--1HW9P.src-components-Chessboard-Square-classes__Square--1yCGb {\n  background-color: #c0c0c0;\n  background-color: var(--black-square-color);\n}\n","",{version:3,sources:["webpack://./src/components/Chessboard/Square/classes.css"],names:[],mappings:"AAAA;EACE,YAAY;EACZ,WAAW;EACX,eAAe,EAAE,uBAAuB;EACxC,aAAa;EACb,mBAAmB;EACnB,uBAAuB;;EAEvB,2BAA2B;EAC3B,6BAA6B;AAC/B;;AAEA,0EAA0E;AAC1E;EACE,uBAA2C;EAA3C,2CAA2C;AAC7C;;AAEA;EACE,yBAA2C;EAA3C,2CAA2C;AAC7C",sourcesContent:[".Square {\n  height: 32px;\n  width: 32px;\n  font-size: 20px; /* of chessman; FIXME */\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  --white-square-color: white;\n  --black-square-color: #c0c0c0;\n}\n\n/* NOTE: できれば .Square.White にしたいが、そうすると postcss-css-variables がうまく動作しない。 */\n.White.Square {\n  background-color: var(--white-square-color);\n}\n\n.Black.Square {\n  background-color: var(--black-square-color);\n}\n"],sourceRoot:""}]),c.locals={Square:"src-components-Chessboard-Square-classes__Square--1yCGb",White:"src-components-Chessboard-Square-classes__White--2-a8H",Black:"src-components-Chessboard-Square-classes__Black--1HW9P"},s.Z=c},1617:function(e,s,n){"use strict";var a=n(94015),r=n.n(a),o=n(23645),c=n.n(o)()(r());c.push([e.id,".src-components-Chessboard-classes__ChessboardTable--3TZoL {\n  border-collapse: collapse;\n}\n\n.src-components-Chessboard-classes__ChessboardTd--WKSwv {\n  padding: 0;\n}\n","",{version:3,sources:["webpack://./src/components/Chessboard/classes.css"],names:[],mappings:"AAAA;EACE,yBAAyB;AAC3B;;AAEA;EACE,UAAU;AACZ",sourcesContent:[".ChessboardTable {\n  border-collapse: collapse;\n}\n\n.ChessboardTd {\n  padding: 0;\n}\n"],sourceRoot:""}]),c.locals={ChessboardTable:"src-components-Chessboard-classes__ChessboardTable--3TZoL",ChessboardTd:"src-components-Chessboard-classes__ChessboardTd--WKSwv"},s.Z=c}}]);
//# sourceMappingURL=chess.0d9ed558.js.map