(self.webpackChunkreact_app_prototype=self.webpackChunkreact_app_prototype||[]).push([[30],{33720:function(s,e,n){"use strict";n.r(e),n.d(e,{default:function(){return O}});var a=n(67294),r=n(64593),o=n(31753),c=n(276),t=n(14890),l=n(68875),i=n(31941),u=n(59713),C=n.n(u),A=n(63038),m=n.n(A),h=n(94184),d=n.n(h),p=n(84785),b=(0,a.createContext)({picking:null,targets:null,halfMove:null,pickChessman:null,releaseChessman:null});function g(s,e){return s.file===e.file&&s.rank===e.rank}var E=n(17567),f=n(93379),_=n.n(f),k=n(32425),v={insert:"head",singleton:!1},q=(_()(k.Z,v),k.Z.locals||{}),B=function(s){var e=s.chessman,n=s.coord,r=(0,a.useContext)(b),o=r.picking,c=r.pickChessman,t=(0,p.useDrag)({item:{type:"Chessman"},collect:function(s){return{dragging:s.isDragging()}},begin:function(){null==c||c(e,n)}}),l=m()(t,3),i=l[0].dragging,u=l[1],A=l[2],h=(0,a.useMemo)((function(){var s;return d()(q.Chessman,(s={},C()(s,q.Dragging,i),C()(s,q.Picking,null!=o&&g(n,o.source)&&(0,E.Z)(e,o.chessman)),s))}),[i,e,n,o]),f=(0,a.useMemo)((function(){return d()(q.Chessman,q.Preview)}),[]),_=(0,a.useCallback)((function(){null==o&&(null==c||c(e,n))}),[o,c,e,n]);return a.createElement(a.Fragment,null,a.createElement("span",{ref:A,className:f},e.symbol),a.createElement("span",{ref:u,className:h,onClick:_},e.symbol))};var w=n(11471),y={insert:"head",singleton:!1},S=(_()(w.Z,y),w.Z.locals||{}),T=function(s){var e=s.children,n=s.coord,r=(0,a.useContext)(b),o=r.picking,c=r.targets,t=r.halfMove,l=r.releaseChessman,i=(0,a.useMemo)((function(){var s;return null!==(s=null==c?void 0:c.some((function(s){return g(n,s)})))&&void 0!==s&&s}),[n,c]),u=(0,p.useDrop)({accept:"Chessman",drop:function(){null!=o&&(i?null==t||t(o.chessman,o.source,n):null==l||l())}}),A=m()(u,2)[1],h=(0,a.useMemo)((function(){return function(s){return s.file%2==s.rank%2?"black":"white"}(n)}),[n]),E=(0,a.useMemo)((function(){var s;return d()(S.Square,(s={},C()(s,S.White,"white"===h),C()(s,S.Black,"black"===h),C()(s,S.Target,i),s))}),[h,i]),f=(0,a.useCallback)((function(){null!=o&&(i?null==t||t(o.chessman,o.source,n):null==l||l())}),[t,o,n,l,i]);return a.createElement("div",{ref:A,className:E,onClick:f},e)},W=n(1617),Z={insert:"head",singleton:!1},P=(_()(W.Z,Z),W.Z.locals||{}),x=[1,2,3,4,5,6,7,8],D=[8,7,6,5,4,3,2,1],M={resetBoard:i.iH},G=(0,c.$j)((function(s){return{board:s.chess.board}}),M)((function(s){var e=s.board,n=s.resetBoard;return(0,a.useEffect)((function(){n()}),[n]),a.createElement("table",{className:P.ChessboardTable,dir:"ltr"},a.createElement("tbody",null,D.map((function(s){return a.createElement("tr",{key:s},x.map((function(n){var r=new l.Z({file:n,rank:s}),o=e.chessmen.get(r);return a.createElement("td",{key:n,className:P.ChessboardTd},a.createElement(T,{coord:r},void 0!==o?a.createElement(B,{chessman:o,coord:r}):null))})))}))))})),N=n(72152),L=(0,n(85315).vU)({chess:{id:"src.components.App.ChessPage.chess",defaultMessage:"Chess"}}),O=(0,N.D)((function(){var s=(0,o.Z)().formatMessage,e=(0,c.v9)((function(s){return s.chess.picking})),n=(0,c.v9)((function(s){return s.chess.targets})),l=(0,c.I0)();return a.createElement(a.Fragment,null,a.createElement(r.Z,{title:s(L.chess)}),a.createElement(b.Provider,{value:{picking:e,targets:n,halfMove:(0,t.qC)(l,i.p4),pickChessman:(0,t.qC)(l,i.Ns),releaseChessman:(0,t.qC)(l,i.Yu)}},a.createElement(G,null)))}))},32425:function(s,e,n){"use strict";var a=n(94015),r=n.n(a),o=n(23645),c=n.n(o)()(r());c.push([s.id,'.src-components-Chessboard-Chessman-classes__Chessman--1Ls2d {\n  font-family: "Apple Symbols", sans-serif;\n  color: #222;\n}\n\n.src-components-Chessboard-Chessman-classes__Chessman--1Ls2d.src-components-Chessboard-Chessman-classes__Dragging--28aag {\n  opacity: 0.5;\n}\n\n.src-components-Chessboard-Chessman-classes__Chessman--1Ls2d.src-components-Chessboard-Chessman-classes__Picking--3PGXm:not(.src-components-Chessboard-Chessman-classes__Dragging--28aag) {\n  color: teal;\n}\n\n/* TODO: in a little more normal way */\n.src-components-Chessboard-Chessman-classes__Chessman--1Ls2d.src-components-Chessboard-Chessman-classes__Preview--1tGRK {\n  position: absolute;\n  z-index: -1;\n}\n',"",{version:3,sources:["webpack://./src/components/Chessboard/Chessman/classes.css"],names:[],mappings:"AAAA;EACE,wCAAwC;EACxC,WAAW;AACb;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,WAAW;AACb;;AAEA,sCAAsC;AACtC;EACE,kBAAkB;EAClB,WAAW;AACb",sourcesContent:['.Chessman {\n  font-family: "Apple Symbols", sans-serif;\n  color: #222;\n}\n\n.Chessman.Dragging {\n  opacity: 0.5;\n}\n\n.Chessman.Picking:not(.Dragging) {\n  color: teal;\n}\n\n/* TODO: in a little more normal way */\n.Chessman.Preview {\n  position: absolute;\n  z-index: -1;\n}\n'],sourceRoot:""}]),c.locals={Chessman:"src-components-Chessboard-Chessman-classes__Chessman--1Ls2d",Dragging:"src-components-Chessboard-Chessman-classes__Dragging--28aag",Picking:"src-components-Chessboard-Chessman-classes__Picking--3PGXm",Preview:"src-components-Chessboard-Chessman-classes__Preview--1tGRK"},e.Z=c},11471:function(s,e,n){"use strict";var a=n(94015),r=n.n(a),o=n(23645),c=n.n(o)()(r());c.push([s.id,".src-components-Chessboard-Square-classes__Square--1yCGb {\n  height: 32px;\n  width: 32px;\n  font-size: 20px; /* of chessman; FIXME */\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  --white-square-color: white;\n  --black-square-color: #c0c0c0;\n}\n\n/* NOTE: できれば .Square.White にしたいが、そうすると postcss-css-variables がうまく動作しない。 */\n.src-components-Chessboard-Square-classes__White--2-a8H.src-components-Chessboard-Square-classes__Square--1yCGb {\n  background-color: white;\n  background-color: var(--white-square-color);\n}\n\n.src-components-Chessboard-Square-classes__Black--1HW9P.src-components-Chessboard-Square-classes__Square--1yCGb {\n  background-color: #c0c0c0;\n  background-color: var(--black-square-color);\n}\n\n.src-components-Chessboard-Square-classes__Target--29CIt {\n  filter: sepia(100%);\n}\n","",{version:3,sources:["webpack://./src/components/Chessboard/Square/classes.css"],names:[],mappings:"AAAA;EACE,YAAY;EACZ,WAAW;EACX,eAAe,EAAE,uBAAuB;EACxC,aAAa;EACb,mBAAmB;EACnB,uBAAuB;;EAEvB,2BAA2B;EAC3B,6BAA6B;AAC/B;;AAEA,0EAA0E;AAC1E;EACE,uBAA2C;EAA3C,2CAA2C;AAC7C;;AAEA;EACE,yBAA2C;EAA3C,2CAA2C;AAC7C;;AAEA;EACE,mBAAmB;AACrB",sourcesContent:[".Square {\n  height: 32px;\n  width: 32px;\n  font-size: 20px; /* of chessman; FIXME */\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  --white-square-color: white;\n  --black-square-color: #c0c0c0;\n}\n\n/* NOTE: できれば .Square.White にしたいが、そうすると postcss-css-variables がうまく動作しない。 */\n.White.Square {\n  background-color: var(--white-square-color);\n}\n\n.Black.Square {\n  background-color: var(--black-square-color);\n}\n\n.Target {\n  filter: sepia(100%);\n}\n"],sourceRoot:""}]),c.locals={Square:"src-components-Chessboard-Square-classes__Square--1yCGb",White:"src-components-Chessboard-Square-classes__White--2-a8H",Black:"src-components-Chessboard-Square-classes__Black--1HW9P",Target:"src-components-Chessboard-Square-classes__Target--29CIt"},e.Z=c},1617:function(s,e,n){"use strict";var a=n(94015),r=n.n(a),o=n(23645),c=n.n(o)()(r());c.push([s.id,".src-components-Chessboard-classes__ChessboardTable--3TZoL {\n  border-collapse: collapse;\n}\n\n.src-components-Chessboard-classes__ChessboardTd--WKSwv {\n  padding: 0;\n}\n","",{version:3,sources:["webpack://./src/components/Chessboard/classes.css"],names:[],mappings:"AAAA;EACE,yBAAyB;AAC3B;;AAEA;EACE,UAAU;AACZ",sourcesContent:[".ChessboardTable {\n  border-collapse: collapse;\n}\n\n.ChessboardTd {\n  padding: 0;\n}\n"],sourceRoot:""}]),c.locals={ChessboardTable:"src-components-Chessboard-classes__ChessboardTable--3TZoL",ChessboardTd:"src-components-Chessboard-classes__ChessboardTd--WKSwv"},e.Z=c}}]);
//# sourceMappingURL=chess.87141cc4.js.map