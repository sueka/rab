"use strict";(self.webpackChunkrap=self.webpackChunkrap||[]).push([[6962],{71289:function(e,t,n){n.r(t),n.d(t,{default:function(){return H}});var a=n(67294),l=n(64593),s=n(31753),r=n(13833),u=n(28889),c=n(282),o=n(64436),i=n(30553),h=n(96019),v=n(62822),m=n(50998),d=n(95757),E=n(40074),p=n(67162),C=n(44845),f=n(22318),g=n(97127),b=n(43587),Z=n(16787),k=n(41120),w=n(94184),x=n.n(w),y=n(46121),A=n(17326),P=n(49527),S=n(11634);class M extends S.Z{constructor(e){let{red:t,green:n,blue:a,alpha:l}=e;super(),this.red=t,this.green=n,this.blue=a,this.alpha=l}hashCode(){let e=0;return e=31*e+this.red.hashCode(),e=31*e+this.green.hashCode(),e=31*e+this.blue.hashCode(),e=31*e+this.alpha.hashCode(),e}}function B(e,t){let{x:n,y:a}=e;const{data:[l,s,r,u]}=t.getImageData(n,a,1,1);return(0,y.s)(l),(0,y.s)(s),(0,y.s)(r),(0,y.s)(u),new M({red:l,green:s,blue:r,alpha:u})}var O=n(93379),D=n.n(O),R=n(14830),T={insert:"head",singleton:!1},q=(D()(R.Z,T),R.Z.locals||{});const z=(0,k.Z)({Canvas:e=>{let{width:t,height:n}=e;return{width:t,height:n}}});var X=(0,a.forwardRef)(((e,t)=>{let{width:n,height:l,lineWidth:s,context:r,tool:u}=e;const[c,o]=(0,a.useState)(!1),[i,h]=(0,a.useState)(null),v=(0,a.useRef)(null),m=(0,A.Z)(t,v),d=z({width:n,height:l}),E=(0,a.useMemo)((()=>x()(d.Canvas,q.Canvas)),[d.Canvas]),{dpr:p}=(0,Z.Z)();(0,a.useEffect)((()=>{null!=r&&null!==v.current&&null!==p&&(v.current.width=p*n,v.current.height=p*l,r.resetTransform(),r.scale(p,p))}),[n,l,r,v,p]);const C=(0,a.useCallback)((e=>{"pen"===u&&((0,y.M)(i),o(!0),h({x:e.nativeEvent.offsetX,y:e.nativeEvent.offsetY}))}),[u,i]),f=(0,a.useCallback)((e=>{c&&((0,y.s)(r),(0,y.s)(i),r.lineWidth=s*(0!==e.pressure?e.pressure:1),r.lineJoin="round",r.beginPath(),r.moveTo(i.x,i.y),r.lineTo(e.nativeEvent.offsetX,e.nativeEvent.offsetY),r.stroke(),h({x:e.nativeEvent.offsetX,y:e.nativeEvent.offsetY}))}),[s,r,c,i]),g=(0,a.useCallback)((()=>{o(!1),h(null)}),[]),b=(0,a.useCallback)((()=>{o(!1),h(null)}),[]),k=(0,a.useCallback)((async e=>{"bucket"===u&&((0,y.s)(r),await async function(e,t,n,a){(0,y.s)(a);const l=[],s=B(e,a);for(l.push(e);0!==l.length;){const e=l.shift();(0,y.s)(e);const r=B(e,a);s.equals(r)&&(a.fillRect(e.x,e.y,1,1),e.x>0&&l.push({x:e.x-1,y:e.y}),e.y>0&&l.push({x:e.x,y:e.y-1}),e.x<t-1&&l.push({x:e.x+1,y:e.y}),e.y<n-1&&l.push({x:e.x,y:e.y+1}),await(0,P.Z)(30))}}({x:e.nativeEvent.offsetX,y:e.nativeEvent.offsetY},n,l,r))}),[n,l,r,u]);return a.createElement("canvas",{ref:m,className:E,width:n,height:l,onPointerDown:C,onPointerMove:f,onPointerUp:g,onPointerLeave:b,onClick:k})})),Y=n(74540),_=n(20590),U=n(5391),W=n(26663);var F=e=>{let{value:t,onChange:n}=e;return a.createElement(W.Z,{orientation:"vertical",exclusive:!0,value:t,onChange:n},a.createElement(U.Z,{value:"pen"},a.createElement(Y.Z,null)),a.createElement(U.Z,{value:"bucket",disabled:!0},a.createElement(_.Z,null)))},I=n(85315),J=(0,I.vU)({clear:{id:"src.components.Paint.clear",defaultMessage:"Clear"},brushSize:{id:"src.components.Paint.brushSize",defaultMessage:"Brush size"}});const L=(0,b.gB)("butt","round","square"),N=(0,b.gB)("pen","bucket");var j=()=>{const[e,t]=(0,a.useState)(),[n,l]=(0,a.useState)("round"),[s,r]=(0,a.useState)(10),[b,k]=(0,a.useState)("pen"),{dpr:w}=(0,Z.Z)(),x=(0,a.useCallback)((e=>{t(null==e?void 0:e.getContext("2d"))}),[]),y=(0,a.useCallback)((()=>{null==e||e.clearRect(0,0,320,320)}),[e]),A=(0,a.useCallback)(((e,t)=>{N(t)&&k(t)}),[]),P=(0,a.useCallback)((e=>{L(e.target.value)&&l(e.target.value)}),[]),S=(0,a.useCallback)(((e,t)=>{if(Array.isArray(t))throw new Error;r(t)}),[]);return(0,a.useEffect)((()=>{null!=e&&(e.lineCap=n)}),[e,n]),a.createElement(a.Fragment,null,a.createElement(X,{width:320,height:320,lineWidth:s,ref:x,context:e,tool:b}),a.createElement(c.Z,{onClick:y},a.createElement(g.Z,J.clear)),a.createElement(F,{value:b,onChange:A}),a.createElement(o.Z,{disabled:"pen"!==b},a.createElement(h.Z,null,"line cap"),a.createElement(p.Z,{name:"lineCap",value:n,onChange:P},a.createElement(i.Z,{value:"butt",label:"butt",control:a.createElement(E.Z,null)}),a.createElement(i.Z,{value:"round",label:"round",control:a.createElement(E.Z,null)}),a.createElement(i.Z,{value:"square",label:"square",control:a.createElement(E.Z,null)}))),a.createElement(u.Z,{m:1},a.createElement(v.Z,null,a.createElement(m.Z,null,a.createElement(d.Z,null,a.createElement(f.Z,{gutterBottom:!0},a.createElement(g.Z,J.brushSize)),a.createElement(C.Z,{min:1/(null!=w?w:1),value:s,onChange:S}))))))},G=(0,I.vU)({paint:{id:"src.components.App.PaintPage.paint",defaultMessage:"Paint"}});var H=(0,r.D)((()=>{const{formatMessage:e}=(0,s.Z)();return a.createElement(a.Fragment,null,a.createElement(l.Z,{title:e(G.paint)}),a.createElement(j,null))}))},14830:function(e,t,n){var a=n(94015),l=n.n(a),s=n(23645),r=n.n(s)()(l());r.push([e.id,".src-components-Paint-Canvas-classes__Canvas--wOskn {\n  background-color: white; /* TODO */\n}\n","",{version:3,sources:["webpack://./src/components/Paint/Canvas/classes.css"],names:[],mappings:"AAAA;EACE,uBAAuB,EAAE,SAAS;AACpC",sourcesContent:[".Canvas {\n  background-color: white; /* TODO */\n}\n"],sourceRoot:""}]),r.locals={Canvas:"src-components-Paint-Canvas-classes__Canvas--wOskn"},t.Z=r}}]);
//# sourceMappingURL=paint.b8ed3fcb.js.map