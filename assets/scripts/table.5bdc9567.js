(self.webpackChunkrap=self.webpackChunkrap||[]).push([[4986],{19593:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return U}});var a=n(95477),r=n(67294),l=n(64593),s=n(31753),i=n(35369),u=n(15659),o=n(26353),d=n(8920),c=n(79895),E=n(82302),m=n(99613),S=n(17196),f=n(56847),_=n(83750),v=n(57394),h=n(77256),O=n(51206);function p(e,t){return e<t?-1:e>t?1:0}const y=n.n(O)().getParser(navigator.userAgent).is("Mobile");var g=({columns:e,rows:t,defaultSortOrder:n="asc"})=>{const[a,l]=(0,r.useState)([]),s=(0,r.useMemo)((()=>a[0]),[a]),u=(0,r.useCallback)((e=>()=>{if(e===(null==s?void 0:s.by))l((([e,...t])=>[{by:e.by,in:"asc"===e.in?"desc":"asc"},...t]));else{const t=a.findIndex((t=>t.by===e));l(-1===t?t=>[{by:e,in:n},...t]:e=>[e[t],...e.slice(0,t),...e.slice(t+1)])}}),[n,a,s]),o=(0,r.useMemo)((()=>a.reduceRight(((e,t)=>e.sortBy((e=>String(e[t.by])),((e,n)=>{switch(t.in){case"asc":return p(e,n);case"desc":return-p(e,n)}}))),(0,i.aV)(t)).toArray()),[a,t]),O=(0,d.Z)();return r.createElement(f.Z,{component:c.Z},r.createElement(E.Z,{size:y?"small":"medium"},r.createElement(_.Z,null,r.createElement(v.Z,null,e.map((e=>{var t,l,i,o;return r.createElement(S.Z,{variant:"head",sortDirection:null===(t=a.find((t=>t.by===e.field)))||void 0===t?void 0:t.in,style:{minWidth:void 0!==e.width?e.width+2*O.spacing(2):void 0},key:e.field},r.createElement(h.Z,{active:(null==s?void 0:s.by)===e.field,direction:null!==(l=null===(i=a.find((t=>t.by===e.field)))||void 0===i?void 0:i.in)&&void 0!==l?l:n,onClick:u(e.field)},null!==(o=e.label)&&void 0!==o?o:e.field))})))),r.createElement(m.Z,null,o.map(((t,n)=>r.createElement(v.Z,{hover:!0,key:n},(0,i.zN)(Object.entries(t)).sortBy(((t,n)=>e.findIndex((e=>e.field===n))),((e,t)=>e-t)).map(((e,t)=>r.createElement(S.Z,{key:t},e))).valueSeq().toArray()))))))},b=n(38780),w=n(46121),A=n(37868);function I(e,t){const[n,a]=(0,r.useState)(null),[l,s]=(0,r.useState)(null),[i,u]=(0,r.useState)(null),[o,d]=(0,r.useState)(null);switch((0,r.useEffect)((()=>{a((0,A.ZP)(e,t)),d("pending")}),[e,t]),o){case"pending":throw(0,w.s)(n),n.then((e=>{s(e),d("fulfilled")})).catch((e=>{if(!(e instanceof Error))throw new TypeError("Non-error reason caught.");u(e),d("rejected")}));case null:case"fulfilled":return l;case"rejected":throw i}}var G=n(25818),T=n(13665);const Z=T.vl,L=(0,T.P7)(Z),M=(0,T.El)("DIMENSION_UNSPECIFIED","COLUMNS","ROWS"),N=(0,T.su)((e=>({range:(0,T.jt)(T.XC)(e.range),majorDimension:(0,T.jt)(M)(e.majorDimension),values:(0,T.jt)(L)(e.values)}))),P=(0,T.su)((e=>({sheets:(0,T.jt)((0,T.P7)(j))(e.sheets)}))),j=(0,T.su)((e=>({data:(0,T.jt)((0,T.P7)(D))(e.data)}))),D=(0,T.su)((e=>({columnMetadata:(0,T.jt)((0,T.P7)(H))(e.columnMetadata)}))),H=(0,T.su)((e=>({pixelSize:(0,T.jt)(T.mH)(e.pixelSize)})));function C(e){switch(typeof e){case"string":case"number":return!0;default:return!1}}var k=()=>{const e=(0,u.useInjection)("EnvVarConfig"),t=I((0,o.Gn)(G.Z`${e.get("SHEETS_API_URL")}/spreadsheets/:spreadsheetId\\?ranges=:sheetName&includeGridData=:includeGridData&fields=:fields&key=:apiKey`,{spreadsheetId:e.get("GOOGLE_SHEETS_FOSS_COMPARISON_TABLE_SHEET_ID"),sheetName:e.get("GOOGLE_SHEETS_FOSS_COMPARISON_TABLE_SHEET_SHEET_NAME"),includeGridData:!0,fields:"sheets.data.columnMetadata",apiKey:e.get("GOOGLE_CLOUD_APIS_GOOGLE_SHEETS_API_KEY")})),n=I((0,o.Gn)(G.Z`${e.get("SHEETS_API_URL")}/spreadsheets/:spreadsheetId/values/:sheetName\\?key=:apiKey`,{spreadsheetId:e.get("GOOGLE_SHEETS_FOSS_COMPARISON_TABLE_SHEET_ID"),sheetName:e.get("GOOGLE_SHEETS_FOSS_COMPARISON_TABLE_SHEET_SHEET_NAME"),apiKey:e.get("GOOGLE_CLOUD_APIS_GOOGLE_SHEETS_API_KEY")})),[a,l]=(0,r.useState)(null),[s,d]=(0,r.useState)(null);return(0,r.useEffect)((()=>{(async()=>{var e,a;if(null===t||null===n)return;const r=null===(e=P(await t.json()).sheets)||void 0===e||null===(a=e[0].data)||void 0===a?void 0:a[0].columnMetadata,s=N(await n.json());if(void 0===r)throw new Error("No columnMetadata found.");if("ROWS"!==(null==s?void 0:s.majorDimension))throw new Error("Dimension unsupported.");if(void 0===s.values||!s.values.every(Array.isArray))throw new Error("Less than 2 dimensions found.");if(!s.values.every((e=>e.every(C))))throw new Error("Neither string nor number value found.");const[i,...u]=s.values,o=i.map(((e,t)=>G.Z`${e}_${t}`));l(Array.from((0,b.Z)(o,(0,b.Z)(i,r))).map((([e,[t,{pixelSize:n}]])=>({field:e,label:t,width:n})))),d(u.map((e=>Object.fromEntries((0,b.Z)(o,e)))))})()}),[t,n]),null===a||null===s?null:r.createElement(g,{columns:(0,i.aV)(a).sortBy((e=>e.field),((e,t)=>e<t?-1:e>t?1:0)).toArray(),rows:s})},R=n(13833),B=(0,n(85315).vU)({table:{id:"src.components.App.TablePage.table",defaultMessage:"Table"}});var U=(0,R.D)((()=>{const{formatMessage:e}=(0,s.Z)();return r.createElement(r.Fragment,null,r.createElement(l.q,{title:e(B.table)}),r.createElement(r.Suspense,{fallback:r.createElement(a.Z,null)},r.createElement(k,null)))}))}}]);
//# sourceMappingURL=table.5bdc9567.js.map