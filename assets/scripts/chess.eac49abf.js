(self.webpackChunkreact_app_prototype=self.webpackChunkreact_app_prototype||[]).push([[30],{93412:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return O}});var a=n(67294),r=n(15482),o=n(67100),t=n(18048),c=n(14890),l=n(16354),i=n(9354),u=n(59713),h=n.n(u),m=n(63038),d=n.n(m),p=n(94184),C=n.n(p),g=n(1342),f=(0,a.createContext)({picking:null,targets:null,halfMove:null,pickChessman:null,releaseChessman:null});function _(e,s){return e.file===s.file&&e.rank===s.rank}var b=n(39116),v=n(7114),k=n.n(v),q=function(e){var s=e.chessman,n=e.coord,r=(0,a.useContext)(f),o=r.picking,t=r.pickChessman,c=(0,g.c)({item:{type:"Chessman"},collect:function(e){return{dragging:e.isDragging()}},begin:function(){null==t||t(s,n)}}),l=d()(c,3),i=l[0].dragging,u=l[1],m=l[2],p=(0,a.useMemo)((function(){var e;return C()(k().Chessman,(e={},h()(e,k().Dragging,i),h()(e,k().Picking,null!=o&&_(n,o.source)&&(0,b.Z)(s,o.chessman)),e))}),[i,s,n,o]),v=(0,a.useMemo)((function(){return C()(k().Chessman,k().Preview)}),[]),q=(0,a.useCallback)((function(){null==o&&(null==t||t(s,n))}),[o,t,s,n]);return a.createElement(a.Fragment,null,a.createElement("span",{ref:m,className:v},s.symbol),a.createElement("span",{ref:u,className:p,onClick:q},s.symbol))},w=n(18035);var T=n(80374),E=n.n(T),y=function(e){var s=e.children,n=e.coord,r=(0,a.useContext)(f),o=r.picking,t=r.targets,c=r.halfMove,l=r.releaseChessman,i=(0,a.useMemo)((function(){var e;return null!==(e=null==t?void 0:t.some((function(e){return _(n,e)})))&&void 0!==e&&e}),[n,t]),u=(0,w.L)({accept:"Chessman",drop:function(){null!=o&&(i?null==c||c(o.chessman,o.source,n):null==l||l())}}),m=d()(u,2)[1],p=(0,a.useMemo)((function(){return function(e){return e.file%2==e.rank%2?"black":"white"}(n)}),[n]),g=(0,a.useMemo)((function(){var e;return C()(E().Square,(e={},h()(e,E().White,"white"===p),h()(e,E().Black,"black"===p),h()(e,E().Target,i),e))}),[p,i]),b=(0,a.useCallback)((function(){null!=o&&(i?null==c||c(o.chessman,o.source,n):null==l||l())}),[c,o,n,l,i]);return a.createElement("div",{ref:m,className:g,onClick:b},s)},M=n(5296),S=n.n(M),x=[1,2,3,4,5,6,7,8],D=[8,7,6,5,4,3,2,1],P={resetBoard:i.iH},N=(0,t.$j)((function(e){return{board:e.chess.board}}),P)((function(e){var s=e.board,n=e.resetBoard;return(0,a.useEffect)((function(){n()}),[n]),a.createElement("table",{className:S().ChessboardTable,dir:"ltr"},a.createElement("tbody",null,D.map((function(e){return a.createElement("tr",{key:e},x.map((function(n){var r=new l.Z({file:n,rank:e}),o=s.chessmen.get(r);return a.createElement("td",{key:n,className:S().ChessboardTd},a.createElement(y,{coord:r},void 0!==o?a.createElement(q,{chessman:o,coord:r}):null))})))}))))})),W=n(80508),B=(0,n(62945).vU)({chess:{id:"src.components.App.ChessPage.chess",defaultMessage:"chess"}}),O=(0,W.D)((function(){var e=(0,o.Z)().formatMessage,s=(0,t.v9)((function(e){return e.chess.picking})),n=(0,t.v9)((function(e){return e.chess.targets})),l=(0,t.I0)();return a.createElement(a.Fragment,null,a.createElement(r.ZP,{title:e(B.chess)}),a.createElement(f.Provider,{value:{picking:s,targets:n,halfMove:(0,c.qC)(l,i.p4),pickChessman:(0,c.qC)(l,i.Ns),releaseChessman:(0,c.qC)(l,i.Yu)}},a.createElement(N,null)))}))},19653:function(e,s,n){(s=n(23645)(!1)).push([e.id,'.src-components-Chessboard-Chessman-classes__Chessman--1H9tu {\n  font-family: "Apple Symbols", sans-serif;\n  color: #222;\n}\n\n.src-components-Chessboard-Chessman-classes__Dragging--3Wg1a {\n  opacity: 0.5;\n}\n\n.src-components-Chessboard-Chessman-classes__Picking--11tdl:not(.src-components-Chessboard-Chessman-classes__Dragging--3Wg1a) {\n  color: teal;\n}\n\n/* TODO: in a little more normal way */\n.src-components-Chessboard-Chessman-classes__Preview--2T3_G {\n  position: absolute;\n  z-index: -1;\n}\n',""]),s.locals={Chessman:"src-components-Chessboard-Chessman-classes__Chessman--1H9tu",Dragging:"src-components-Chessboard-Chessman-classes__Dragging--3Wg1a",Picking:"src-components-Chessboard-Chessman-classes__Picking--11tdl",Preview:"src-components-Chessboard-Chessman-classes__Preview--2T3_G"},e.exports=s},63945:function(e,s,n){(s=n(23645)(!1)).push([e.id,".src-components-Chessboard-Square-classes__Square--3eloU {\n  height: 32px;\n  width: 32px;\n  font-size: 20px; /* of chessman; FIXME */\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  --white-square-color: white;\n  --black-square-color: #c0c0c0\n\n  /* TODO: Consider Nav */\n}\n\n@media screen and (orientation: portrait) {\n\n.src-components-Chessboard-Square-classes__Square--3eloU {\n    height: 12.5vw;\n    width: 12.5vw;\n    font-size: 7.8125vw\n}\n  }\n\n.src-components-Chessboard-Square-classes__White--7ZYQX {\n  background-color: var(--white-square-color);\n}\n\n.src-components-Chessboard-Square-classes__Black--3wDR_ {\n  background-color: var(--black-square-color);\n}\n\n.src-components-Chessboard-Square-classes__Target--11gMT {\n  filter: sepia(100%);\n}\n",""]),s.locals={Square:"src-components-Chessboard-Square-classes__Square--3eloU",White:"src-components-Chessboard-Square-classes__White--7ZYQX",Black:"src-components-Chessboard-Square-classes__Black--3wDR_",Target:"src-components-Chessboard-Square-classes__Target--11gMT"},e.exports=s},94741:function(e,s,n){(s=n(23645)(!1)).push([e.id,".src-components-Chessboard-classes__ChessboardTable--1YTjE {\n  border-collapse: collapse;\n}\n\n.src-components-Chessboard-classes__ChessboardTd--3hHrO {\n  padding: 0;\n}\n",""]),s.locals={ChessboardTable:"src-components-Chessboard-classes__ChessboardTable--1YTjE",ChessboardTd:"src-components-Chessboard-classes__ChessboardTd--3hHrO"},e.exports=s},7114:function(e,s,n){var a=n(93379),r=n(19653);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.id,r,""]]);var o={insert:"head",singleton:!1};a(r,o);e.exports=r.locals||{}},80374:function(e,s,n){var a=n(93379),r=n(63945);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.id,r,""]]);var o={insert:"head",singleton:!1};a(r,o);e.exports=r.locals||{}},5296:function(e,s,n){var a=n(93379),r=n(94741);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.id,r,""]]);var o={insert:"head",singleton:!1};a(r,o);e.exports=r.locals||{}}}]);
//# sourceMappingURL=chess.eac49abf.js.map