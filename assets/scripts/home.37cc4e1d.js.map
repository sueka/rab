{"version":3,"file":"assets/scripts/home.37cc4e1d.js","mappings":"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","sources":["webpack://rap/./src/components/FormattedTimeOfDay/index.tsx","webpack://rap/./src/components/CurrentTimeOfDay/index.tsx","webpack://rap/./src/identity.ts","webpack://rap/./src/components/NotifyMeButton/messages.ts","webpack://rap/./src/components/NotifyMeButton/index.tsx","webpack://rap/./src/hooks/useOnceForEachEffect.ts","webpack://rap/./src/components/ObtainCookieConsentBanner/index.tsx","webpack://rap/./src/components/ObtainCookieConsentButton/messages.ts","webpack://rap/./src/components/ObtainCookieConsentButton/index.tsx","webpack://rap/./src/components/SetClockButton/messages.ts","webpack://rap/./src/components/SetClockButton/index.tsx","webpack://rap/./src/components/Today/index.tsx","webpack://rap/./src/components/App/HomePage/messages.ts","webpack://rap/./src/components/App/HomePage/index.tsx","webpack://rap/./src/components/Banner/index.tsx","webpack://rap/./src/components/ObtainCookieConsentBanner/messages.ts","webpack://rap/./src/globalVariables/cookieDialogKey.ts","webpack://rap/./src/globalVariables/reloadNotToAcceptCookiesBannerKey.ts","webpack://rap/./src/hooks/useBanner.ts"],"sourcesContent":["import React from 'react'\nimport { CustomFormatConfig, FormattedTime } from 'react-intl'\n\ntype Props =\n  & Alt.Omit<Intl.DateTimeFormatOptions, /* 'dateStyle' |  */'weekday' | 'era' | 'year' | 'month' | 'day'>\n  & CustomFormatConfig\n  & {\n      value: string | number | Date | undefined\n    }\n\nconst FormattedTimeOfDay: React.FC<Props> = (props) => (\n  <FormattedTime\n    { ...props }\n    // dateStyle={ undefined }\n    weekday={ undefined }\n    era={ undefined }\n    year={ undefined }\n    month={ undefined }\n    day={ undefined }\n  />\n)\n\nexport default FormattedTimeOfDay\n","import React from 'react'\nimport { connect } from 'react-redux'\n\nimport FormattedTimeOfDay from '~/components/FormattedTimeOfDay'\nimport { State } from '~/redux'\n\ninterface StateProps {\n  now: Date\n}\n\ntype Props =\n  & StateProps\n\n// TODO: delete?\nconst CurrentTimeOfDay: React.FC<Props> = ({ now }) => (\n  <FormattedTimeOfDay value={ now } format=\"medium\" />\n)\n\n// connect\n\nconst mapStateToProps = ({ io: { now } }: State): StateProps => ({\n  now,\n})\n\nexport default connect(mapStateToProps)(CurrentTimeOfDay)\n","const identity = <T extends U, U>(it: T): U => it\n\nexport default identity\n","import { defineMessages } from 'react-intl'\n\nexport default defineMessages({\n  sendPushNotification: 'Send push notification',\n})\n","import IconButton from '@material-ui/core/IconButton'\nimport Tooltip from '@material-ui/core/Tooltip'\nimport SendIcon from '@material-ui/icons/Send'\nimport React, { useCallback, useMemo } from 'react'\nimport { FormattedMessage } from 'react-intl'\nimport { useRecoilState } from 'recoil'\n\nimport notificationsState from '~/atoms/notificationsState'\nimport useOnceForEachEffect from '~/hooks/useOnceForEachEffect'\nimport messages from './messages'\n\ninterface Props {\n  inputFor: React.RefObject<HTMLInputElement | HTMLTextAreaElement>\n}\n\nconst NotifyMeButton: React.FC<Props> = ({ inputFor: ref }) => {\n  const [notifications, setNotifications] = useRecoilState(notificationsState)\n  const disabled = useMemo(() => ref.current === null || /^\\p{White_Space}*$/u.test(ref.current.value), [ref.current?.value])\n\n  const handleNotifyButtonClick = useCallback<React.MouseEventHandler<HTMLButtonElement>>(async () => {\n    const input = ref.current\n\n    if (input === null) {\n      return\n    }\n\n    const permission = await Notification.requestPermission()\n\n    if (permission === 'granted') {\n      setNotifications((ns) => [...ns, new Notification(input.value)])\n    }\n  }, [ref])\n\n  const handleNotificationClose = useCallback<NonNullable<Notification['onclose']>>((event) => {\n    const notification = event.target\n\n    if (!(notification instanceof Notification)) {\n      return\n    }\n\n    setNotifications((ns) => ns.filter((n) => n !== notification))\n  }, [])\n\n  useOnceForEachEffect(notifications, undefined, (notification) => {\n    notification.addEventListener('close', handleNotificationClose)\n  }, [notifications, handleNotificationClose])\n\n  if (!('Notification' in globalThis)) {\n    return null\n  }\n\n  return (\n    <Tooltip\n      title={ <FormattedMessage { ...messages.sendPushNotification } /> }\n      disableFocusListener={ disabled }\n      disableHoverListener={ disabled }\n      disableTouchListener={ disabled }\n    >\n      <span>\n        <IconButton\n          onClick={ handleNotifyButtonClick }\n          disabled={ disabled }\n        >\n          <SendIcon />\n        </IconButton>\n      </span>\n    </Tooltip>\n  )\n}\n\nexport default NotifyMeButton\n","import { DependencyList, useEffect } from 'react'\n\nimport identity from '~/identity'\n\ntype OnceForEachEffectCallback<T> = (x: T) => (void | ((x: T) => void | undefined))\n\n/**\n * @param identify that meets `a` is `b` in SameValueZero → `identify(a) === identify(b)`\n */\nexport default function useOnceForEachEffect<T, U = T>(xs: readonly T[], identify: (x: T) => U = identity as (x: T) => U, effect: OnceForEachEffectCallback<T>, deps?: DependencyList) { // TODO: delete `as (x: T) => U`; 引数の型は反変なので、デフォルト引数の型は、引数の型と同じかそれより狭い型に安全に変換できるが、 TypeScript の実装はそうなっていない。\n  useEffect(() => {\n    const cleanups: {\n      x: T,\n      cleanup: ReturnType<typeof effect>\n    }[] = []\n\n    const doneIds: U[] = []\n\n    // tslint:disable-next-line:no-loop-statement\n    for (const x of xs) {\n      const id = identify(x)\n\n      if (!doneIds.includes(id)) {\n        // tslint:disable-next-line:no-array-mutation\n        cleanups.push({\n          x,\n          cleanup: effect(x),\n        })\n\n        // tslint:disable-next-line:no-array-mutation\n        doneIds.push(id)\n      }\n    }\n\n    return () => {\n      // tslint:disable-next-line:no-loop-statement\n      for (const { x, cleanup } of cleanups) {\n        // cleanup?.(x)\n\n        if (typeof cleanup !== 'undefined') {\n          cleanup(x)\n        }\n      }\n    }\n  }, deps ?? []) // eslint-disable-line react-hooks/exhaustive-deps\n}\n","import Avatar from '@material-ui/core/Avatar'\nimport Button from '@material-ui/core/Button'\nimport SecurityIcon from '@material-ui/icons/Security'\nimport React from 'react'\nimport { FormattedMessage } from 'react-intl'\nimport { useRecoilCallback } from 'recoil'\n\nimport cookieConsentObtainedState from '~/atoms/cookieConsentObtainedState'\nimport Banner from '~/components/Banner'\nimport messages from './messages'\n\ninterface Props {\n  onAgree?(): void\n  onCancel?(): void\n}\n\nconst ObtainCookieConsentBanner: React.FC<Props> = ({ onAgree, onCancel }) => {\n  const handleAgree = useRecoilCallback(({ set }) => () => {\n    set(cookieConsentObtainedState, true)\n\n    onAgree?.()\n  }, [onAgree])\n\n  return (\n    <Banner\n      leading={ <Avatar>\n        <SecurityIcon />\n      </Avatar> }\n      text={ <FormattedMessage { ...messages.weUseCookiesToAnalyzeOurTraffic } /> }\n      actions={ <>\n        <Button variant=\"text\" color=\"primary\" onClick={ handleAgree }>\n          <FormattedMessage { ...messages.agree } />\n        </Button>\n        <Button variant=\"text\" color=\"primary\" onClick={ onCancel }>\n          <FormattedMessage { ...messages.cancel } />\n        </Button>\n      </> }\n    />\n  )\n}\n\nexport default ObtainCookieConsentBanner\n","import { defineMessages } from 'react-intl'\n\nexport default defineMessages({\n  consentToUseCookies: 'Consent to use cookies…',\n  youHaveAlreadyConsentedToUseCookies: 'You have already consented to use cookies.',\n})\n","import Button from '@material-ui/core/Button'\nimport { useInjection } from 'inversify-react'\nimport { useSnackbar } from 'notistack'\nimport React, { useCallback } from 'react'\nimport { FormattedMessage } from 'react-intl'\nimport { useRecoilValue } from 'recoil'\n\nimport { shouldBePresent } from '~/asserters/commonAsserters'\nimport cookieConsentObtainedState from '~/atoms/cookieConsentObtainedState'\nimport ObtainCookieConsentBanner from '~/components/ObtainCookieConsentBanner'\nimport ConfigRegistry from '~/config/ConfigRegistry'\nimport cookieDialogKey from '~/globalVariables/cookieDialogKey'\nimport reloadNotToAcceptCookiesBannerKey from '~/globalVariables/reloadNotToAcceptCookiesBannerKey'\nimport useBanner from '~/hooks/useBanner'\nimport useGtm from '~/hooks/useGtm'\nimport currentBannerState from '~/selectors/currentBannerState'\nimport messages from './messages'\n\n// NOTE: このコンポーネントがアンマウント、再マウントされても dismiss がうまく動くように、グローバルな `cookieDialogKey` を使っている。これを解消するには、 `cookieDialogKey` を prop にするか、 <RecoilRoot> を分割する。\n/**\n * クッキーダイアログを表示するボタンを表現する.\n *\n * NOTE: https://github.com/mdn/content/blob/f4556b8707dcdd6fec9c6f121a24e6988309f95c/files/en-us/web/api/notification/requestpermission/index.html#L87-L89 と同じような理由で、 Rap では、ユーザーの操作無しにクッキーダイアログを表示することはしない。\n */\nconst ObtainCookieConsentButton: React.FC = () => {\n  const config = useInjection<ConfigRegistry>('EnvVarConfig')\n  const gtmContainerId = config.get('GTM_CONTAINER_ID')\n  const gtm = useGtm()\n  const banner = useBanner()\n  const { enqueueSnackbar } = useSnackbar()\n  const cookieConsentObtained = useRecoilValue(cookieConsentObtainedState)\n  const currentBanner = useRecoilValue(currentBannerState)\n\n  const handleAgree = useCallback(() => {\n    shouldBePresent(gtmContainerId)\n\n    // NOTE: 画面のちらつきを減らすために、裏にある方を先に隠す。\n    banner.hide({\n      key: reloadNotToAcceptCookiesBannerKey,\n      safe: true,\n    })\n\n    banner.hide({ key: cookieDialogKey })\n\n    gtm.install(gtmContainerId)\n  }, [banner, gtm, gtmContainerId])\n\n  const handleCancel = useCallback(() => {\n    banner.hide({ key: cookieDialogKey })\n  }, [banner])\n\n  // NOTE: すでに表示されているバナーに `handleAgree` や `handleCancel` の変更を反映させるには、 useEffect 等を使って、 `handleAgree` や `handleCancel` が変更されるたびに、現在のバナーの `key` が `cookieDialogKey` と一致するかどうかを調べ、一致する場合は同じ `key` を使って `banner.show()` する。\n  const handleClick = useCallback<React.MouseEventHandler<HTMLButtonElement>>(() => {\n    if (!cookieConsentObtained) {\n      banner.show(<ObtainCookieConsentBanner\n        onAgree={ handleAgree }\n        onCancel={ handleCancel }\n      />, {\n        key: cookieDialogKey,\n        replaceable: true,\n      })\n    } else {\n      enqueueSnackbar(<FormattedMessage { ...messages.youHaveAlreadyConsentedToUseCookies } />)\n    }\n  }, [cookieConsentObtained, banner, handleAgree, handleCancel, enqueueSnackbar])\n\n  return (\n    <Button onClick={ handleClick } disabled={ currentBanner?.key === cookieDialogKey }>\n      <FormattedMessage { ...messages.consentToUseCookies } />\n    </Button>\n  )\n}\n\nexport default ObtainCookieConsentButton\n","import { defineMessages } from 'react-intl'\n\nexport default defineMessages({\n  setTheClock: 'Set the clock',\n})\n","import Button from '@material-ui/core/Button'\nimport React from 'react'\nimport { FormattedMessage} from 'react-intl'\nimport { connect } from 'react-redux'\n\nimport { updateNow } from '~/redux/modules/io'\nimport messages from './messages'\n\ninterface DispatchProps {\n  updateNow(): void\n}\n\ntype Props =\n  & DispatchProps\n\n// TODO: delete\nconst SetClockButton: React.FC<Props> = ({ updateNow }) => (\n  <Button onClick={ updateNow }>\n    <FormattedMessage { ...messages.setTheClock } />\n  </Button>\n)\n\n// connect\n\nconst mapDispatchToProps: DispatchProps = {\n  updateNow,\n}\n\nexport default connect(null, mapDispatchToProps)(SetClockButton)\n","import React from 'react'\nimport { FormattedDate } from 'react-intl'\nimport { connect } from 'react-redux'\n\nimport { State } from '~/redux'\n\ninterface StateProps {\n  now: Date\n}\n\ntype Props =\n  & StateProps\n\n// TODO: delete?\nconst Today: React.FC<Props> = ({ now }) => (\n  <FormattedDate value={ now } format=\"medium\" />\n)\n\n// connect\n\nconst mapStateToProps = ({ io: { now } }: State): StateProps => ({\n  now,\n})\n\nexport default connect(mapStateToProps)(Today)\n","import { defineMessages } from 'react-intl'\n\nexport default defineMessages({\n  home: 'Home',\n})\n","import InputAdornment from '@material-ui/core/InputAdornment'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport { useInjection } from 'inversify-react'\nimport React, { useCallback, useEffect, useRef, useState } from 'react'\nimport Helmet from 'react-helmet'\nimport { FormattedNumber, useIntl } from 'react-intl'\n\nimport CurrentTimeOfDay from '~/components/CurrentTimeOfDay'\nimport NotifyMeButton from '~/components/NotifyMeButton'\nimport ObtainCookieConsentButton from '~/components/ObtainCookieConsentButton'\nimport { createPage } from '~/components/PageTemplate'\nimport SetClockButton from '~/components/SetClockButton'\nimport Today from '~/components/Today'\nimport ConfigRegistry from '~/config/ConfigRegistry'\nimport messages from './messages'\n\nconst crateImport = import('~/crate/pkg')\n\nconst HomePage: React.FC = () => {\n  const config = useInjection<ConfigRegistry>('EnvVarConfig')\n  const gtmContainerId = config.get('GTM_CONTAINER_ID')\n  const { formatMessage } = useIntl()\n  const input = useRef<HTMLInputElement>(null)\n  const [text, setText] = useState('')\n\n  const handleChange = useCallback<React.ChangeEventHandler<HTMLInputElement>>((event) => {\n    setText(event.target.value)\n  }, [])\n\n  useEffect(() => {\n    // tslint:disable-next-line:semicolon\n    ;(async () => {\n      const { add } = await crateImport\n\n      console.log(add(1, 1)) // tslint:disable-line:no-console\n    })()\n  }, [])\n\n  return (\n    <>\n      <Helmet title={ formatMessage(messages.home) } />\n      <Typography>\n        <FormattedNumber format=\"usd\" value={ 100 } />\n      </Typography>\n      <Typography>\n        <Today /> <CurrentTimeOfDay />\n      </Typography>\n      <SetClockButton />\n      <TextField\n        value={ text }\n        onChange={ handleChange }\n        InputProps={ {\n          endAdornment: (\n            <InputAdornment position=\"end\">\n              <NotifyMeButton inputFor={ input } />\n            </InputAdornment>\n          ),\n        } }\n        inputProps= { {\n          ref: input,\n        } }\n      />\n      { gtmContainerId !== undefined && <ObtainCookieConsentButton /> }\n    </>\n  )\n}\n\nexport default createPage(HomePage)\n","import { AvatarProps } from '@material-ui/core/Avatar'\nimport Box from '@material-ui/core/Box'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport Bowser from 'bowser'\nimport React from 'react'\n\nimport Spacer from '~/components/Spacer'\n\nexport interface Props {\n  leading?: React.ReactElement<AvatarProps, React.ComponentType<AvatarProps>>\n  text: React.ReactNode\n  actions: React.ReactNode\n}\n\n// TODO: Remove\n// TODO: Detect UA changes?\nconst browser = Bowser.getParser(navigator.userAgent)\n\nconst isMobile = browser.is('Mobile')\n\n/**\n * An implementation of https://material.io/components/banners.\n *\n * NOTE: Not support the no leading, mobile, one-line version.\n */\nconst Banner: React.FC<Props> = ({ leading, text, actions }) => (\n  <Paper square elevation={ 0 }>\n    <Box\n      display=\"flex\"\n      flexWrap=\"nowrap\"\n      alignItems={ isMobile ? 'flex-start' : 'center' }\n    >\n      { leading !== undefined && (\n        <Box\n          my={ isMobile ? 3 : 2 }\n          ml={ 2 }\n        >\n          { leading }\n        </Box>\n      ) }\n      <Box\n        alignSelf=\"stretch\"\n        display=\"flex\"\n        flexGrow={ 1 }\n        alignItems={ isMobile ? 'flex-start' : 'center' }\n        flexWrap={ isMobile ? 'wrap' : undefined }\n        gridColumnGap={ (isMobile ? 36 : 90) - 16 }\n        gridRowGap={ isMobile ? (leading !== undefined ? 20 : 12) - 10 : undefined }\n      >\n        <Box\n          mt={ isMobile ? 3 : 2 }\n          mb={ isMobile ? undefined : 2 }\n          ml={ isMobile ? 2 : 3 }\n          mr={ 1 }\n        >\n          <Typography variant=\"body2\">{ text }</Typography>{ /* TODO: Align to baseline */ }\n        </Box>\n        <Box\n          alignSelf=\"flex-end\"\n          display=\"flex\"\n          flexGrow={ 1 }\n        >\n          <Spacer />\n          <Box\n            mt={ isMobile ? 1.25 : 1 }\n            mx={ 1 }\n            mb={ 1 }\n            display=\"flex\"\n            gridColumnGap={ 8 }\n          >\n            { actions }\n          </Box>\n        </Box>\n      </Box>\n    </Box>\n  </Paper>\n)\n\nexport default Banner\n","import { defineMessages } from 'react-intl'\n\nexport default defineMessages({\n  weUseCookiesToAnalyzeOurTraffic: 'We use cookies to analyze our traffic.',\n  agree: 'Agree',\n  cancel: 'Cancel',\n})\n","import { v4 } from 'uuid'\n\nconst cookieDialogKey = v4()\n\nexport default cookieDialogKey\n","import { v4 } from 'uuid'\n\nconst reloadNotToAcceptCookiesBannerKey = v4()\n\nexport default reloadNotToAcceptCookiesBannerKey\n","import { useRecoilCallback } from 'recoil'\nimport { v4 } from 'uuid'\n\nimport bannersState from '~/atoms/bannersState'\nimport { Props as BannerProps } from '~/components/Banner'\nimport currentBannerState from '~/selectors/currentBannerState'\n\ntype BannerElement = React.ReactElement<BannerProps, React.ComponentType<BannerProps>>\n\ninterface ShowOptions {\n  key?: string\n  replaceable?: boolean\n}\n\ninterface HideOptions {\n  key?: string\n  safe?: boolean // no failures if true\n}\n\nconst useBanner = () => {\n  const show = useRecoilCallback(({ set }) => (banner: BannerElement, options?: ShowOptions) => {\n    const key = options?.key ?? v4()\n    const replaceable = options?.replaceable ?? false\n\n    set(currentBannerState, {\n      banner,\n      key,\n      replaceable,\n    })\n\n    return key\n  })\n\n  const hide = useRecoilCallback(({ set }) => (options?: HideOptions) => {\n    const key = options?.key\n    const safe = options?.safe ?? false\n\n    if (key === undefined) {\n      set(currentBannerState, (currentBanner) => {\n        if (currentBanner === null && !safe) {\n          throw new Error('No banner found.')\n        }\n\n        return null\n      })\n    } else {\n      set(bannersState, (banners) => {\n        const i = banners.findIndex((banner) => banner.key === key)\n\n        if (i === -1 && !safe) {\n          throw new Error('No banner found.')\n        }\n\n        if (i !== -1) {\n          return [\n            ...banners.slice(0, i),\n            ...banners.slice(i + 1),\n          ]\n        }\n\n        return banners\n      })\n    }\n  })\n\n  return { show, hide }\n}\n\nexport default useBanner\n"],"names":["props","weekday","undefined","era","year","month","day","connect","io","now","value","format","it","defineMessages","sendPushNotification","inputFor","ref","notifications","setNotifications","useRecoilState","notificationsState","disabled","useMemo","current","test","handleNotifyButtonClick","useCallback","async","input","Notification","requestPermission","ns","handleNotificationClose","event","notification","target","filter","n","xs","identify","identity","effect","deps","useEffect","cleanups","doneIds","x","id","includes","push","cleanup","useOnceForEachEffect","addEventListener","globalThis","Tooltip","title","messages","disableFocusListener","disableHoverListener","disableTouchListener","IconButton","onClick","Send","onAgree","onCancel","handleAgree","useRecoilCallback","set","cookieConsentObtainedState","Banner","leading","Avatar","Security","text","actions","Button","variant","color","consentToUseCookies","youHaveAlreadyConsentedToUseCookies","gtmContainerId","useInjection","get","gtm","useGtm","banner","useBanner","enqueueSnackbar","useSnackbar","cookieConsentObtained","useRecoilValue","currentBanner","currentBannerState","shouldBePresent","hide","key","reloadNotToAcceptCookiesBannerKey","safe","cookieDialogKey","install","handleCancel","handleClick","show","replaceable","setTheClock","mapDispatchToProps","updateNow","home","crateImport","createPage","formatMessage","useIntl","useRef","setText","useState","handleChange","add","console","log","Helmet","Typography","TextField","onChange","InputProps","endAdornment","InputAdornment","position","inputProps","isMobile","Bowser","navigator","userAgent","is","square","elevation","display","flexWrap","alignItems","my","ml","alignSelf","flexGrow","gridColumnGap","gridRowGap","mt","mb","mr","mx","weUseCookiesToAnalyzeOurTraffic","agree","cancel","v4","options","Error","bannersState","banners","i","findIndex","slice"],"sourceRoot":""}