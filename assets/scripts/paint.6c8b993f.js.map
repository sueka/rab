{"version":3,"file":"assets/scripts/paint.6c8b993f.js","mappings":"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","sources":["webpack://rap/./src/domain/vo/Color.ts","webpack://rap/./src/utils/canvas/floodFill.ts","webpack://rap/./src/components/Paint/Canvas/classes.css?1804","webpack://rap/./src/components/Paint/Canvas/index.tsx","webpack://rap/./src/components/Paint/Toolbox/index.tsx","webpack://rap/./src/components/Paint/messages.ts","webpack://rap/./src/components/Paint/index.tsx","webpack://rap/./src/components/App/PaintPage/messages.ts","webpack://rap/./src/components/App/PaintPage/index.tsx","webpack://rap/./src/components/Paint/Canvas/classes.css"],"sourcesContent":["import HashableEq from '~/trait/HashableEq'\n\n// TODO: Remove\ninterface RgbaColor {\n  red: number\n  green: number\n  blue: number\n  alpha: number\n}\n\nexport default interface Color extends RgbaColor {}\n\nexport default class Color extends HashableEq implements Class.ValueObject<RgbaColor> {\n  constructor({ red, green, blue, alpha }: RgbaColor) {\n    super()\n\n    this.red = red\n    this.green = green\n    this.blue = blue\n    this.alpha = alpha\n  }\n\n  public hashCode() {\n    let result = 0\n\n    result = 31 * result + this.red.hashCode()\n    result = 31 * result + this.green.hashCode()\n    result = 31 * result + this.blue.hashCode()\n    result = 31 * result + this.alpha.hashCode()\n\n    return result\n  }\n}\n","import { shouldBePresent } from '~/asserters/commonAsserters'\nimport delay from '~/delay'\nimport Color from '~/domain/vo/Color'\n\nexport /* for testing */ function getColor({ x, y }: Canvas.Point, context: CanvasRenderingContext2D): Color {\n  const { data: [red, green, blue, alpha] } = context.getImageData(x, y, 1, 1)\n\n  // NOTE: getImageData の仕様上必ず存在する。 cf. https://html.spec.whatwg.org/multipage/canvas.html#dom-context-2d-getimagedata and https://html.spec.whatwg.org/multipage/canvas.html#initialize-an-imagedata-object\n  shouldBePresent(red)\n  shouldBePresent(green)\n  shouldBePresent(blue)\n  shouldBePresent(alpha)\n\n  return new Color({\n    red,\n    green,\n    blue,\n    alpha,\n  })\n}\n\nexport default async function floodFill(targetPoint: Canvas.Point, width: number, height: number, context: CanvasRenderingContext2D) {\n  shouldBePresent(context)\n\n  const queue: Canvas.Point[] = [] // TODO\n  const targetColor = getColor(targetPoint, context)\n\n  queue.push(targetPoint)\n\n  while (queue.length !== 0) {\n    const currentPoint = queue.shift()\n\n    shouldBePresent(currentPoint)\n\n    const currentColor = getColor(currentPoint, context)\n\n    if (!targetColor.equals(currentColor)) {\n      continue\n    }\n\n    context.fillRect(currentPoint.x, currentPoint.y, 1, 1)\n\n    if (currentPoint.x > 0) {\n      queue.push({ x: currentPoint.x - 1, y: currentPoint.y })\n    }\n\n    if (currentPoint.y > 0) {\n      queue.push({ x: currentPoint.x, y: currentPoint.y - 1 })\n    }\n\n    if (currentPoint.x < width - 1) {\n      queue.push({ x: currentPoint.x + 1, y: currentPoint.y })\n    }\n\n    if (currentPoint.y < height - 1) {\n      queue.push({ x: currentPoint.x, y: currentPoint.y + 1 })\n    }\n\n    await delay(30)\n  }\n}\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[3].use[1]!../../../../node_modules/postcss-loader/dist/cjs.js!./classes.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[3].use[1]!../../../../node_modules/postcss-loader/dist/cjs.js!./classes.css\";\n       export default content && content.locals ? content.locals : undefined;\n","import { Theme, makeStyles } from '@material-ui/core/styles'\nimport classnames from 'classnames'\nimport React, { forwardRef, useCallback, useEffect, useMemo, useRef, useState } from 'react'\n\nimport { shouldBeNullish, shouldBePresent } from '~/asserters/commonAsserters'\nimport useRefsMerged from '~/hooks/useRefsMerged'\nimport useScreen from '~/hooks/useScreen'\nimport floodFill from '~/utils/canvas/floodFill'\nimport classes from './classes.css'\n\ninterface Props {\n  width: number\n  height: number\n  lineWidth: number\n  context: CanvasRenderingContext2D | null | undefined\n  tool: Canvas.Tool\n}\n\ninterface StyleProps {\n  width: number\n  height: number\n}\n\nconst useStyles = makeStyles<Theme, StyleProps, 'Canvas'>({\n  Canvas: ({ width, height }) => ({\n    width,\n    height,\n  }),\n})\n\nconst Canvas = forwardRef<HTMLCanvasElement, Props>(({ width, height, lineWidth, context, tool }, forwardedRef) => {\n  const [drawing, setDrawing] = useState(false)\n  const [previousPoint, setPreviousPoint] = useState<Canvas.Point | null>(null)\n\n  const ownRef = useRef<HTMLCanvasElement>(null)\n  const ref = useRefsMerged(forwardedRef, ownRef)\n\n  const jssClasses = useStyles({ width,  height })\n  const canvasClassName = useMemo(() => classnames(jssClasses.Canvas, classes.Canvas), [jssClasses.Canvas])\n\n  const { dpr } = useScreen()\n\n  useEffect(() => {\n    if (context == null || ownRef.current === null || dpr === null) {\n      return\n    }\n\n    ownRef.current.width = dpr * width\n    ownRef.current.height = dpr * height\n\n    context.resetTransform()\n    context.scale(dpr, dpr)\n  }, [width, height, context, ownRef, dpr])\n\n  const handlePointerDown = useCallback<React.PointerEventHandler<HTMLCanvasElement>>((event) => {\n    if (tool !== 'pen') {\n      return\n    }\n\n    shouldBeNullish(previousPoint)\n\n    setDrawing(true)\n\n    setPreviousPoint({\n      x: event.nativeEvent.offsetX,\n      y: event.nativeEvent.offsetY,\n    })\n  }, [tool, previousPoint])\n\n  const handlePointerMove = useCallback<React.PointerEventHandler<HTMLCanvasElement>>((event) => {\n    if (!drawing) {\n      return\n    }\n\n    shouldBePresent(context)\n    shouldBePresent(previousPoint)\n\n    context.lineWidth = lineWidth * (event.pressure !== 0 ? event.pressure : 1)\n    context.lineJoin = 'round'\n\n    context.beginPath()\n    context.moveTo(previousPoint.x, previousPoint.y)\n    context.lineTo(event.nativeEvent.offsetX, event.nativeEvent.offsetY)\n    context.stroke()\n\n    setPreviousPoint({\n      x: event.nativeEvent.offsetX,\n      y: event.nativeEvent.offsetY,\n    })\n  }, [lineWidth, context, drawing, previousPoint])\n\n  const handlePointerUp = useCallback(() => {\n    setDrawing(false)\n    setPreviousPoint(null)\n  }, [])\n\n  const handlePointerLeave = useCallback(() => {\n    setDrawing(false)\n    setPreviousPoint(null)\n  }, [])\n\n  const handleClick = useCallback<React.MouseEventHandler<HTMLCanvasElement>>(async (event) => {\n    if (tool !== 'bucket') {\n      return\n    }\n\n    shouldBePresent(context)\n\n    await floodFill({ x: event.nativeEvent.offsetX, y: event.nativeEvent.offsetY }, width, height, context)\n  }, [width, height, context, tool])\n\n  return (\n    <canvas\n      ref={ ref }\n      className={ canvasClassName }\n      width={ width }\n      height={ height }\n      onPointerDown={ handlePointerDown }\n      onPointerMove={ handlePointerMove }\n      onPointerUp={ handlePointerUp }\n      onPointerLeave={ handlePointerLeave }\n      onClick={ handleClick }\n    />\n  )\n})\n\nexport default Canvas\n","import CreateIcon from '@material-ui/icons/Create'\nimport FormatColorFillIcon from '@material-ui/icons/FormatColorFill'\nimport ToggleButton from '@material-ui/lab/ToggleButton'\nimport ToggleButtonGroup, { ToggleButtonGroupProps } from '@material-ui/lab/ToggleButtonGroup'\nimport React from 'react'\n\n// TODO: Remove\ntype Tool =\n  | 'pen'\n  | 'bucket'\n\nexport interface Props {\n  value: Tool\n  onChange: NonNullable<ToggleButtonGroupProps['onChange']>\n}\n\nconst Toolbox: React.FC<Props> = ({ value, onChange }) => (\n  <ToggleButtonGroup orientation=\"vertical\" exclusive value={ value } onChange={ onChange }>\n    <ToggleButton value=\"pen\">\n      <CreateIcon />\n    </ToggleButton>\n    <ToggleButton value=\"bucket\" disabled>\n      <FormatColorFillIcon />\n    </ToggleButton>\n  </ToggleButtonGroup>\n)\n\nexport default Toolbox\n","import { defineMessages } from 'react-intl'\n\nexport default defineMessages({\n  clear: 'Clear',\n  brushSize: 'Brush size',\n})\n","import Box from '@material-ui/core/Box'\nimport Button from '@material-ui/core/Button'\nimport FormControl from '@material-ui/core/FormControl'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Radio from '@material-ui/core/Radio'\nimport RadioGroup from '@material-ui/core/RadioGroup'\nimport Slider from '@material-ui/core/Slider'\nimport Typography from '@material-ui/core/Typography'\nimport React, { useCallback, useEffect, useState } from 'react'\nimport { FormattedMessage } from 'react-intl'\n\nimport { isOneOf } from '~/guards/commonGuards'\nimport useScreen from '~/hooks/useScreen'\nimport Canvas from './Canvas'\nimport Toolbox, { Props as ToolboxProps } from './Toolbox'\nimport messages from './messages'\n\n// TODO: Remove\ntype Tool =\n  | 'pen'\n  | 'bucket'\n\nconst isCanvasLineCap = isOneOf('butt', 'round', 'square')\nconst isTool = isOneOf('pen', 'bucket')\n\nconst WIDTH = 320\nconst HEIGHT = 320\n\nconst Paint: React.FC = () => {\n  const [context, setContext] = useState<CanvasRenderingContext2D | null>()\n  const [lineCap, setLineCap] = useState<CanvasLineCap>('round')\n  const [lineWidth, setLineWidth] = useState<number>(10)\n  const [tool, setTool] = useState<Tool>('pen')\n  const { dpr } = useScreen()\n\n  const canvas = useCallback<React.RefCallback<HTMLCanvasElement>>((node) => {\n    setContext(node?.getContext('2d'))\n  }, [])\n\n  const handleClick = useCallback<React.MouseEventHandler<HTMLButtonElement>>(() => {\n    context?.clearRect(0, 0, WIDTH, HEIGHT)\n  }, [context])\n\n  const handleToolChange = useCallback<ToolboxProps['onChange']>((_event, value) => {\n    if (!isTool(value)) {\n      return\n    }\n\n    setTool(value)\n  }, [])\n\n  const handlePenCapRadioChange = useCallback<React.ChangeEventHandler<HTMLInputElement>>((event) => {\n    if (isCanvasLineCap(event.target.value)) {\n      setLineCap(event.target.value)\n    }\n  }, [])\n\n  const handleLineWidthSliderChange = useCallback<Required<React.PropsOf<typeof Slider>>['onChange']>((_event, value) => {\n    if (Array.isArray(value)) {\n      throw new Error\n    }\n\n    setLineWidth(value)\n  }, [])\n\n  useEffect(() => {\n    if (context == null) {\n      return\n    }\n\n    context.lineCap = lineCap\n  }, [context, lineCap])\n\n  return (\n    <>\n      <Canvas width={ WIDTH } height={ HEIGHT } lineWidth={ lineWidth } ref={ canvas } context={ context } tool={ tool } />\n      <Button onClick={ handleClick }>\n        <FormattedMessage { ...messages.clear } />\n      </Button>\n      <Toolbox value={ tool } onChange={ handleToolChange } />\n      <FormControl disabled={ tool !== 'pen' }>\n        <FormLabel>line cap</FormLabel>\n        <RadioGroup name=\"lineCap\" value={ lineCap } onChange={ handlePenCapRadioChange }>\n          <FormControlLabel value=\"butt\" label=\"butt\" control={ <Radio /> } />\n          <FormControlLabel value=\"round\" label=\"round\" control={ <Radio /> } />\n          <FormControlLabel value=\"square\" label=\"square\" control={ <Radio /> } />\n        </RadioGroup>\n      </FormControl>\n      <Box m={ 1 }>\n        <List>\n          <ListItem>\n            <ListItemText>\n              <Typography gutterBottom><FormattedMessage { ...messages.brushSize } /></Typography>\n              <Slider min={ 1 / (dpr ?? 1) } value={ lineWidth } onChange={ handleLineWidthSliderChange } />\n            </ListItemText>\n          </ListItem>\n        </List>\n      </Box>\n    </>\n  )\n}\n\nexport default Paint\n","import { defineMessages } from 'react-intl'\n\nexport default defineMessages({\n  paint: 'Paint',\n})\n","import React from 'react'\nimport Helmet from 'react-helmet'\nimport { useIntl } from 'react-intl'\n\nimport { createPage } from '~/components/PageTemplate'\nimport Paint from '~/components/Paint'\nimport messages from './messages'\n\nconst PaintPage: React.FC = () => {\n  const { formatMessage } = useIntl()\n\n  return (\n    <>\n      <Helmet title={ formatMessage(messages.paint) } />\n      <Paint />\n    </>\n  )\n}\n\nexport default createPage(PaintPage)\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".src-components-Paint-Canvas-classes__Canvas--aLw0w {\\n  background-color: white; /* TODO */\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/Paint/Canvas/classes.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,uBAAuB,EAAE,SAAS;AACpC\",\"sourcesContent\":[\".Canvas {\\n  background-color: white; /* TODO */\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"Canvas\": \"src-components-Paint-Canvas-classes__Canvas--aLw0w\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n"],"names":["Color","HashableEq","constructor","red","green","blue","alpha","super","this","hashCode","result","getColor","context","x","y","data","getImageData","shouldBePresent","options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","undefined","useStyles","makeStyles","Canvas","width","height","forwardRef","forwardedRef","lineWidth","tool","drawing","setDrawing","useState","previousPoint","setPreviousPoint","ownRef","useRef","ref","useRefsMerged","jssClasses","canvasClassName","useMemo","classnames","classes","dpr","useScreen","useEffect","current","resetTransform","scale","handlePointerDown","useCallback","event","shouldBeNullish","nativeEvent","offsetX","offsetY","handlePointerMove","pressure","lineJoin","beginPath","moveTo","lineTo","stroke","handlePointerUp","handlePointerLeave","handleClick","async","targetPoint","queue","targetColor","push","length","currentPoint","shift","currentColor","equals","fillRect","delay","floodFill","className","onPointerDown","onPointerMove","onPointerUp","onPointerLeave","onClick","value","onChange","ToggleButtonGroup","orientation","exclusive","ToggleButton","Create","disabled","FormatColorFill","defineMessages","clear","brushSize","isCanvasLineCap","isOneOf","isTool","setContext","lineCap","setLineCap","setLineWidth","setTool","canvas","node","getContext","clearRect","handleToolChange","_event","handlePenCapRadioChange","target","handleLineWidthSliderChange","Array","isArray","Error","Button","messages","FormControl","FormLabel","RadioGroup","name","FormControlLabel","label","control","Radio","Box","m","List","ListItem","ListItemText","Typography","gutterBottom","Slider","min","paint","createPage","formatMessage","useIntl","Helmet","title","___CSS_LOADER_EXPORT___","module","id","locals"],"sourceRoot":""}